FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="1.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiB2aXN1YWxzdHVkaW8tcHJvamVjdC1hcGIKaW1hZ2U6IHN0\
ZXJidXJnL3Zpc3VhbHN0dWRpby1wcm9qZWN0LWFwYgpkZXNjcmlwdGlvbjogYSAqVmlzdWFsIFN0\
dWRpbyBUZWFtIFNlcnZpY2VzKiBQcm9qZWN0CmJpbmRhYmxlOiBmYWxzZQphc3luYzogb3B0aW9u\
YWwKdGFnczoKICAtIHZpc3VhbHN0dWRpbwogIC0gd29ya3NwYWNlCm1ldGFkYXRhOgogIGRpc3Bs\
YXlOYW1lOiBWaXN1YWxTdHVkaW8gUHJvamVjdAogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJTYW11\
ZWwgVGVyYnVyZywgSW5jLiIKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL3d3dy52aXN1YWxz\
dHVkaW8uY29tCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBwcm92aXNpb25zIGEgVmlz\
dWFsIFN0dWRpbyBwcm9qZWN0CiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29u\
LW1lZGlhd2lraQpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBGcmVl\
IFN1YnNjcmlwdGlvbgogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlO\
YW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYSBz\
aW5nbGUgdmlzdWFsc3R1ZGlvIHByb2plY3QKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRl\
cnM6CiAgICAgIC0gbmFtZTogcHJvamVjdF9uYW1lCiAgICAgICAgdGl0bGU6IFByb2plY3QgbmFt\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRlZmF1bHQ6IG5vZGVqcy1leAogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogZ2l0X3JlcG8KICAgICAgICB0aXRsZTogRXhp\
c3RpbmcgR0lUIHJlcG9zaXRvcnkgdG8gaW1wb3J0CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgZGVmYXVsdDogaHR0cHM6Ly9naXRodWIuY29tL29wZW5zaGlmdC9ub2RlanMtZXguZ2l0CiAg\
ICAgICAgcmVxdWlyZWQ6IHRydWUK"

ENV PYTHONWARNINGS="ignore:Unverified HTTPS request"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
