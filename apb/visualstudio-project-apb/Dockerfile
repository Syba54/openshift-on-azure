FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="1.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDEuMApuYW1lOiB2aXN1YWxzdHVkaW8tYXBiCmltYWdlOiBzdGVyYnVyZy92\
aXN1YWxzdHVkaW8tYXBiCmRlc2NyaXB0aW9uOiBWaXN1YWxTdHVkaW8gYXBiIGltcGxlbWVudGF0\
aW9uCmJpbmRhYmxlOiBmYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZG9jdW1lbnRh\
dGlvblVybDogaHR0cHM6Ly93d3cudmlzdWFsc3R1ZGlvLmNvbQogIGxvbmdEZXNjcmlwdGlvbjog\
QW4gYXBiIHRoYXQgZGVwbG95cyBhIFZpc3VhbFN0dWRpby5jb20gcHJvamVjdAogIGRpc3BsYXlO\
YW1lOiBWaXN1YWxTdHVkaW8gKEFQQikKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6\
IGljb24tZG90bmV0CiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlNUZXJidXJnLCBJbmMuIgpwbGFu\
czoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBBbiBBUEIgdGhhdCBkZXBsb3lz\
IDEgVmlzdWFsU3R1ZGlvIHByb2plY3QKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAg\
ICBkaXNwbGF5TmFtZTogRGVmYXVsdAogICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBk\
ZXBsb3lzIGEgc2luZ2xlIFZpc3VhbFN0dWRpbyBwcm9qZWN0CiAgICAgIGNvc3Q6ICIkMC4wMCIK\
ICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogZ2l0X3JlcG8KICAgICAgICBkZWZhdWx0OiAi\
aHR0cHM6Ly9naXRodWIuY29tL3JlZGhhdC1kZXZlbG9wZXIvczJpLWRvdG5ldGNvcmUtZXguZ2l0\
IgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBHaXQgUmVwbyB0byBjbG9uZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCg=="

ENV PYTHONWARNINGS="ignore:Unverified HTTPS request"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
