FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="1.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDAuMQppZDogNGZiY2MwNTEtMDNhZi00MGM3LTg2ZTItZGMxMjk3N2U2YjUz\
Cm5hbWU6IHZpc3VhbHN0dWRpby1hcGIKaW1hZ2U6IHN0ZXJidXJnL3Zpc3VhbHN0dWRpby1hcGIK\
ZGVzY3JpcHRpb246ICJWaXN1YWxTdHVkaW8gYXBiIGltcGxlbWVudGF0aW9uIgpiaW5kYWJsZTog\
ZmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiVmlzdWFsU3R1\
ZGlvIChBUEIpIgogIGxvbmdEZXNjcmlwdGlvbjogIkNyZWF0ZXMgYSBWaXN1YWxTdHVkaW8uY29t\
IHByb2plY3QsIGluY2x1ZGluZyBCdWlsZCBQaXBlbGluZSwgaW50ZWdyYXRlZCB3aXRoIE9wZW5T\
aGlmdCBTMkkuIgogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogZmEtd2luZG93cwog\
IGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL3d3dy52aXN1YWxzdHVkaW8uY29tIgpwYXJhbWV0\
ZXJzOgogIC0gZ2l0X3JlcG86CiAgICAgIHRpdGxlOiBHaXQgUmVwbyB0byBjbG9uZQogICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogaHR0cHM6Ly9naXRodWIuY29tL3JlZGhhdC1kZXZl\
bG9wZXIvczJpLWRvdG5ldGNvcmUtZXgwLmdpdApyZXF1aXJlZDoKICAtIGdpdF9yZXBvCnBsYW5z\
OgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEFuIEFQQiB0aGF0IGRlcGxveXMg\
MSBWaXN1YWxTdHVkaW8gcHJvamVjdAogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRhdGE6CiAgICAg\
IGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRl\
cGxveXMgYSBzaW5nbGUgVmlzdWFsU3R1ZGlvIHByb2plY3QKICAgICAgY29zdDogIiQwLjAwIgog\
ICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1lOiBnaXRfcmVwbwogICAgICAgIGRlZmF1bHQ6ICJo\
dHRwczovL2dpdGh1Yi5jb20vcmVkaGF0LWRldmVsb3Blci9zMmktZG90bmV0Y29yZS1leDEuZ2l0\
IgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBHaXQgUmVwbyB0byBjbG9uZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCgo="

ENV PYTHONWARNINGS="ignore:Unverified HTTPS request"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
