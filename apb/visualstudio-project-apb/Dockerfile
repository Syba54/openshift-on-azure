FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="1.0"
LABEL "com.redhat.apb.spec"=\
"LS0tCnZlcnNpb246IDAuMQppZDogNGZiY2MwNTEtMDNhZi00MGM3LTg2ZTItZGMxMjk3N2U2YjUz\
Cm5hbWU6IHZpc3VhbHN0dWRpby1hcGIKaW1hZ2U6IHN0ZXJidXJnL3Zpc3VhbHN0dWRpby1hcGIK\
ZGVzY3JpcHRpb246ICJWaXN1YWxTdHVkaW8gYXBiIGltcGxlbWVudGF0aW9uIDIiCmJpbmRhYmxl\
OiBmYWxzZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJWaXN1YWxT\
dHVkaW8gKEFQQikiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiQW4gYXBiIHRoYXQgY3JlYXRlcyBhIFZp\
c3VhbFN0dWRpbyBwcm9qZWN0IgogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25DbGFzczogaWNv\
bi1kZXNrdG9wCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vd3d3LnZpc3VhbHN0dWRpby5j\
b20iCnBhcmFtZXRlcnM6CiAgLSBnaXRfcmVwbzoKICAgICAgdGl0bGU6IEdpdCBSZXBvIHRvIGNs\
b25lCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiBodHRwczovL2dpdGh1Yi5jb20v\
cmVkaGF0LWRldmVsb3Blci9zMmktZG90bmV0Y29yZS1leDAuZ2l0CnJlcXVpcmVkOgogIC0gZ2l0\
X3JlcG8KcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQW4gQVBCIHRo\
YXQgZGVwbG95cyAxIFZpc3VhbFN0dWRpbyBwcm9qZWN0CiAgICBmcmVlOiB0cnVlCiAgICBtZXRh\
ZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBU\
aGlzIHBsYW4gZGVwbG95cyBhIHNpbmdsZSBWaXN1YWxTdHVkaW8gcHJvamVjdAogICAgICBjb3N0\
OiAiJDAuMDAiCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGdpdF9yZXBvCiAgICAgICAg\
ZGVmYXVsdDogImh0dHBzOi8vZ2l0aHViLmNvbS9yZWRoYXQtZGV2ZWxvcGVyL3MyaS1kb3RuZXRj\
b3JlLWV4MS5naXQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEdpdCBSZXBv\
IHRvIGNsb25lCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKCg=="

ENV PYTHONWARNINGS="ignore:Unverified HTTPS request"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
